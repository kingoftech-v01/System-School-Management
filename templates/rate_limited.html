{% extends "base_auth.html" %}
{% load static i18n %}

{% block title %}{% trans "Rate Limited" %}{% endblock %}

{% block auth_title %}{% trans "Rate Limited" %}{% endblock %}
{% block auth_subtitle %}{% trans "Too many requests" %}{% endblock %}

{% block content %}
<div class="text-center">
    <div class="mb-4">
        <i class="bi bi-exclamation-triangle text-warning" style="font-size: 5rem;"></i>
    </div>

    <h3 class="mb-3">{% trans "Slow Down!" %}</h3>

    <p class="text-muted mb-4">
        {% trans "You have made too many requests in a short period of time. Please wait a moment before trying again." %}
    </p>

    <div class="alert alert-warning" role="alert">
        <i class="bi bi-clock me-2"></i>
        {% trans "Please wait" %} <strong id="countdown">{{ retry_after }}</strong> {% trans "seconds before trying again." %}
    </div>

    <div class="mt-4">
        <a href="{% url 'dashboard' %}" class="btn btn-primary">
            <i class="bi bi-house me-2"></i>
            {% trans "Return to Dashboard" %}
        </a>
    </div>

    <hr class="my-4">

    <div class="text-start">
        <h6 class="fw-bold">{% trans "Why am I seeing this?" %}</h6>
        <p class="text-muted small">
            {% trans "To protect our system and ensure fair usage for all users, we implement rate limiting. This prevents abuse and ensures the platform remains responsive for everyone." %}
        </p>

        <h6 class="fw-bold mt-3">{% trans "How to avoid this:" %}</h6>
        <ul class="text-muted small">
            <li>{% trans "Avoid refreshing pages repeatedly" %}</li>
            <li>{% trans "Wait for page content to fully load before clicking" %}</li>
            <li>{% trans "Use proper navigation instead of browser refresh" %}</li>
        </ul>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Countdown timer
let seconds = {{ retry_after|default:60 }};
const countdownElement = document.getElementById('countdown');

const timer = setInterval(function() {
    seconds--;
    if (countdownElement) {
        countdownElement.textContent = seconds;
    }

    if (seconds <= 0) {
        clearInterval(timer);
        // Auto-redirect to previous page
        window.location.reload();
    }
}, 1000);
</script>
{% endblock %}
